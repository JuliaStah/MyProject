(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8466],{61415:function(t,e,n){"use strict";n.d(e,{d:function(){return o},z:function(){return u}});var i=n(67294),r=n(81043),a=n(17777),s=n(15810),l=n(27211);let o=t=>{let e=(0,r.v9)(s.k1),n=(0,a.K)(),i=(0,r.v9)(s.K6)??0,{localItems:l}=n,o=u(),c=l.filter(t=>{let e=0===t.discounts.length;return e&&o(t.productInfo.offerId)});return t?.total?.petcoinBalance?.available!=void 0&&!!e?.petcoin_enabled&&i>=e.petcoin_levels[0].count&&c.length>0},u=()=>{let t=(0,r.I0)(),e=(0,r.v9)(s.k1),n=(0,r.v9)(l.je);return(0,i.useCallback)(i=>(null===e&&t((0,s.kN)()),e&&e.petcoin_enabled&&null===n.petcoinOfferIds&&t((0,l.JK)({id:e.petcoin_pim_selection_id})),!!n&&!!e&&!!n.petcoinOfferIds&&!!i&&n.petcoinOfferIds.length>0&&n.petcoinOfferIds.includes(i.toString())),[e,n])}},16995:function(t,e,n){"use strict";n.d(e,{j:function(){return o}});var i=n(85893),r=n(81043),a=n(25675),s=n.n(a),l=n(15810);let o=({width:t,height:e,fill:n=!1,alternative:a=!1,disabled:o=!1})=>{let u=(0,r.v9)(l.k1);if(null===u||u?.petcoin_img?.url===null||u?.petcoin_img?.url==="")return(0,i.jsx)(i.Fragment,{});let c=n?void 0:t??u.petcoin_img.width,p=n?void 0:e??u.petcoin_img.height,d=o?u?.petcoin_img_disabled?.url:a?u?.petcoin_img_label?.url:u?.petcoin_img?.url;return(0,i.jsx)(s(),{src:d,width:c,height:p,layout:n?"fill":void 0,objectFit:n?"contain":void 0,unoptimized:!0})}},13947:function(t,e,n){"use strict";n.d(e,{tY:function(){return o},zT:function(){return u},hT:function(){return c},RP:function(){return a},s6:function(){return r}});let i=(t,e)=>{let n=Math.abs(t)%100,i=n%10;return n>10&&n<20?e[2]:i>1&&i<5?e[1]:1==i?e[0]:e[2]},r=(t,e)=>t?.length<e?.length?s(t,e).concat(t):t,a=(t,e)=>{if(null===e)return t;let n={};return Object.keys(e).forEach(i=>{e[i]?.cartItemIds?.length>t[i]?.cartItemIds?.length&&(n[i]=e[i]),e[i]?.cartItemIds?.length<t[i]?.cartItemIds?.length&&(n[i]=l(t[i],e[i])),e[i]?.cartItemIds?.length===t[i]?.cartItemIds?.length&&(n[i]=t[i])}),n},s=(t,e)=>e.filter(e=>!t.find(t=>e?.article===t?.article)),l=(t,e)=>{let n=t.cartItemIds,i=e.cartItemIds;return{...t,cartItemIds:n.concat(i.filter(t=>0>n.indexOf(t)))}},o=t=>{if(!t)return null;let e=[];return t.map(t=>{t.quantityHasBeenChanged.changed&&e.push(t)}),e},u=t=>t.filter(t=>t.isGift),c=t=>`${t||0} ${i(t||0,["товар","товара","товаров",])} в корзине`},15365:function(t,e,n){"use strict";n.d(e,{m:function(){return w}});var i=n(85893),r=n(97266),a=n(67294),s=n(94184),l=n.n(s),o=n(40077),u=n(4305),c=n(32195),p=n(12763),d=n(82336),f=n(35345),m=n(77088);let _=t=>{switch(t){case r.p.Changed_items:return"Эти товары закончились,\nпопробуйте заказать их позже:";case r.p.Promotion:return"При удалении товара подарки по акции будут также удалены:";case r.p.Info:return"У некоторых товаров изменилось \nколичество, доступное к покупке:";case r.p.Confirmation:return"При удалении товара, товары ниже будут также удалены:";case r.p.Gifts:return"При удалении товара подарки по акции будут также удалены:";default:return"При удалении товара, товары ниже будут также удалены:"}},h=t=>{var e;let n=[];return t&&Boolean("cartItemId"in t)&&Array.isArray(t)&&(t.forEach(t=>{t.quantityHasBeenChanged?.changed&&n.push(r.p.Info)}),t.forEach(t=>{t.giftDiscountExternalId&&n.push(r.p.Promotion)}),t.forEach(t=>{0===t.stockQuantity&&(n.push(r.p.Confirmation),n=n.filter(t=>"info"!==t))}),t.forEach(t=>{t.isGift&&n.push(r.p.Gifts)})),n};var x=n(20145),g=n(27319),C=n.n(g);let I=({item:t,variant:e,isPopupCard:n,noCounter:a=!1})=>{let s=e===r.p.Info||r.p.Changed_items,{measure:o,picture:u,quantityAvailable:c,quantityOrder:p,title:d}=t;return(0,i.jsxs)("li",{className:l()(C().root),children:[(0,i.jsx)("img",{className:C().image,src:u||x.G.image,alt:"",title:""}),(0,i.jsxs)("div",{className:C().content,children:[(0,i.jsx)("div",{className:l()(n?"text-b2":"text-b3"),children:d}),(0,i.jsx)("div",{className:C().quantities,children:!a&&s&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("span",{className:l()(C().old,"text-interface"),children:`${p} ${o}`}),(0,i.jsx)("span",{className:l()("text-interface",C().new),children:`${c} ${o}`})]})})]})]})};var j=n(34164),v=n.n(j);let b=({item:t,variant:e,isPopupCard:n,noCounter:a=!1})=>{let s=e===r.p.Info||r.p.Changed_items,{productInfo:o,quantityHasBeenChanged:u,maxStockCount:c,isGift:p}=t,{media:d,name:f,skuPackings:m}=o,_=m[0].amountUnit;return(0,i.jsxs)("li",{className:l()(v().root),children:[(0,i.jsx)("img",{className:v().image,src:d?.media||x.G.image,alt:d?.alt,title:d?.title}),(0,i.jsxs)("div",{className:v().content,children:[(0,i.jsx)("div",{className:l()(n?"text-b2":"text-b3"),children:f}),(0,i.jsxs)("div",{className:v().quantities,children:[p&&(0,i.jsx)("span",{className:l()("text-interface",v().gift),children:"Подарок"}),!a&&s&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("span",{className:l()(v().old,"text-interface"),children:`${u?.previousQuantity} ${_}`}),(0,i.jsx)("span",{className:l()("text-interface",v().new),children:`${c} ${_}`})]})]})]})]})};var N=n(96191),P=n.n(N);let w=({items:t,onClose:e,variant:n,handleConfirm:s,isVisibleConfirmPopup:x,handleCancel:g})=>{let C=n||h(t),j=C.includes(r.p.Confirmation)||C.includes(r.p.Gifts),{0:v,1:N}=(0,a.useState)(!0),w=(0,c.d)(),y=()=>{N(!1),e?.()},k=C.includes(r.p.Gifts);return Boolean(t.length)?(0,i.jsx)(u.r,{children:(0,i.jsx)(m.default,{shown:j?x:v,onClose:j?e:y,fullscreenXs:!0,closeButton:!0,children:(0,i.jsxs)(f.J,{className:P().wrapper,width:w?"100%":416,children:[(0,i.jsxs)("section",{className:P().headerWrap,children:[(0,i.jsx)("h3",{className:l()(P().header,w?"text-h2":"text-h3"),children:"обратите внимание"}),Boolean(C[0])?(0,i.jsx)("p",{className:l()("text-interface",P().description),children:_(C[0])}):null]}),(0,i.jsx)(o.Z,{className:P().itemsWrap,children:C.map((e,n)=>(0,i.jsxs)("div",{className:P().listWrap,children:[Boolean(n)&&(0,i.jsx)("p",{className:l()("text-interface",P().description),children:_(e)}),(0,i.jsx)("ul",{className:l()(P().list),children:t.map((t,n)=>{if("picture"in t)return(0,i.jsx)(I,{item:t,variant:r.p.Info},n);switch(e){case r.p.Info:return(0,i.jsx)(b,{item:t,variant:r.p.Info},n);case r.p.Confirmation:return(0,i.jsx)(b,{item:t,isPopupCard:!0},n);case r.p.Promotion:return(0,i.jsx)(b,{item:t},n);case r.p.Gifts:return(0,i.jsx)(b,{item:t,isPopupCard:!0,noCounter:!0},n);default:return(0,i.jsx)(b,{item:t,isPopupCard:!0},n)}})})]},n))}),(0,i.jsxs)("section",{className:P().btnWrapper,children:[(0,i.jsx)(d.Z,{type:"button",themes:["square-black","full-width"],onClick:j?s:y,children:(0,i.jsx)(i.Fragment,{children:(0,i.jsx)("div",{className:l()("text-button-big",{[P().btnTextCenter]:!k}),children:C.includes(r.p.Gifts)?"все равно удалить":C.includes(r.p.Promotion)?"подтвердить удаление":"Понятно"})})}),C.includes(r.p.Promotion)&&(0,i.jsx)(d.Z,{type:"button",themes:["square-purple","full-width"],onClick:g,children:(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("span",{className:"text-button-big purple",children:"вернуть в корзину"}),(0,i.jsx)(p.J,{width:20,height:20,color:"purple",src:"./return.svg"})]})})]})]})})}):null}},95177:function(t,e,n){"use strict";n.d(e,{m:function(){return i.m}});var i=n(15365)},17777:function(t,e,n){"use strict";n.d(e,{K:function(){return p}});var i=n(67294),r=n(81043),a=n(15713),s=n(26584),l=n(13947),o=n(93132),u=n(45605),c=n(25609);let p=()=>{let t=(0,r.v9)(c.dY),e=(0,r.v9)(c.dZ),n=(0,r.v9)(u.IG),{cartId:p}=(0,a.cFf)({customerId:e}),{cartData:d,mutate:f}=(0,a.jD1)(p??"",{customerId:e}),{cartData:m}=(0,a.lm6)(p??"",{customerId:e}),{0:_,1:h}=(0,i.useState)(null),{0:x,1:g}=(0,i.useState)(!1),{0:C,1:I}=(0,i.useState)(!1),{0:j,1:v}=(0,i.useState)(null),{0:b,1:N}=(0,i.useState)([]);(0,i.useEffect)(()=>{d?.total.problems.length&&d.total.problems.forEach(t=>{(0,s.m)({text:t,type:"warning"})}),h((0,l.tY)(d?.items)),v(d?.groups||null),N(d?.items.length?d?.items:[])},[d]),(0,i.useEffect)(()=>{(m?.total.quantity||d?.total.quantity)&&d?.total.quantity!==m?.total.quantity&&f()},[m?.total.quantity,d?.total.quantity]);let P=d?.total?.accruedBonuses??0,w=(0,l.hT)(m?.total.quantity),y=(0,o.Vq)(d?.discounts??[]),k=b.flatMap(({isGift:t,cartItemId:e})=>t?e:[]);return{authUserId:t,customerId:e,cartId:p,cartData:d,changedItems:_,setChangedItems:h,isCheckingCart:x,setIsCheckingCart:g,visibleCartPanel:C,setVisibleCartPanel:I,localGroups:j,setLocalGroups:v,localItems:b,setLocalItems:N,bonuses:P,titleText:w,isExpress:n,miniCartData:m,promotionWithGifts:y,giftCartItems:k}}},93132:function(t,e,n){"use strict";n.d(e,{AR:function(){return s},Vq:function(){return r},nE:function(){return a}});var i=n(13947);let r=t=>t.filter(t=>!!t.giftsQuantity),a=t=>t.map(t=>t.gifts.map(t=>t.offerId)).flat(),s=(t,e,n)=>t.map(t=>({...t,gifts:t.gifts.flatMap(r=>{let a=e.filter(t=>t.offerId===r.offerId)?.[0];if(!a)return[];let s=i.zT(n).filter(e=>e.giftDiscountExternalId===t.externalId&&r.offerId===e.productInfo.offerId)?.[0];return{...r,giftInfo:{name:a?.name,media:a?.media,cartItemId:s?.cartItemId,isSelected:!!s,quantityInCart:s?.quantity||0}}}),giftsQuantity:t?.giftsQuantity||0}))},12763:function(t,e,n){"use strict";n.d(e,{J:function(){return i.J}});var i=n(4757)},34164:function(t){t.exports={root:"CardMini_root__Q7QWy",image:"CardMini_image__3IE1W",content:"CardMini_content__MxL9M",quantities:"CardMini_quantities__emuSw",old:"CardMini_old__VnM8d",new:"CardMini_new__W0P15",gift:"CardMini_gift__VLQTD",popupCart:"CardMini_popupCart__lFzBd"}},96191:function(t){t.exports={wrapper:"PopupCart_wrapper__sQdSw",header:"PopupCart_header__QzIyg",headerWrap:"PopupCart_headerWrap__9_Nia",description:"PopupCart_description__R7WLB",list:"PopupCart_list__J9wdK",btnTextCenter:"PopupCart_btnTextCenter__5j_QN",subtitle:"PopupCart_subtitle__zZsiB",buttonCross:"PopupCart_buttonCross__OeLka",offersItem:"PopupCart_offersItem__LKgfz",btnWrapper:"PopupCart_btnWrapper__tweGk",listWrap:"PopupCart_listWrap__JU_Nt",itemsWrap:"PopupCart_itemsWrap__ZTN63"}},27319:function(t){t.exports={root:"CheckoutPopupCartMini_root__3tqO1",image:"CheckoutPopupCartMini_image___ncUH",content:"CheckoutPopupCartMini_content___HDSc",quantities:"CheckoutPopupCartMini_quantities__w3adZ",old:"CheckoutPopupCartMini_old__GhruH",new:"CheckoutPopupCartMini_new__wOHrT",gift:"CheckoutPopupCartMini_gift__QpAdD",popupCart:"CheckoutPopupCartMini_popupCart__usWjf"}}}]);